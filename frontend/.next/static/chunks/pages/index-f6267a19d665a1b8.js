(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4124)}])},4124:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var a=n(5893),o=n(7294),s=n(7066);n(8883);var r=e=>{var t,n;let{post:s}=e,[r,l]=(0,o.useState)(!1),[c,i]=(0,o.useState)(s.content);(0,o.useEffect)(()=>{r||i(s.content)},[s.content,r]);let u=async()=>{s.token?s.onDelete(s.id):alert("You must be logged in to delete a post.")},d=()=>{s.token?(l(!r),i(s.content)):alert("You must be logged in to edit a post.")},m=async()=>{s.token?(console.log("Updating post ID ".concat(s.id," with content:"),c),await s.onUpdateContent(s.id,c),l(!1)):alert("You must be logged in to update a post.")};return(0,a.jsxs)("div",{className:"note",id:"".concat(s.id),children:[(0,a.jsx)("h2",{children:s.title}),(0,a.jsxs)("small",{children:["By ",null===(t=s.author)||void 0===t?void 0:t.name]}),(0,a.jsx)("br",{}),(0,a.jsx)("small",{children:null===(n=s.author)||void 0===n?void 0:n.email}),r?(0,a.jsx)("textarea",{name:"text_input-".concat(s.id),value:c,onChange:e=>{i(e.target.value)},rows:4,cols:50}):(0,a.jsx)("p",{children:s.content}),(0,a.jsxs)("div",{children:[r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{name:"text_input_save-".concat(s.id),className:"save-button",onClick:m,children:"Save"}),(0,a.jsx)("button",{name:"text_input_cancel-".concat(s.id),className:"cancel-button",onClick:d,children:"Cancel"})]}):(0,a.jsx)("button",{name:"edit-".concat(s.id),className:"edit-button",onClick:d,children:"Edit"}),(0,a.jsx)("button",{name:"delete-".concat(s.id),className:"delete-button",onClick:u,children:"Delete"})]})]})};n(9117);let l=e=>{let{page:t,currPage:n,handlePageChange:o}=e;return(0,a.jsx)("button",{name:"page-".concat(t),onClick:()=>o(t),disabled:t===n,"aria-disabled":t===n,className:"pagination-button ".concat(t===n?"active":""),style:{fontWeight:t===n?"bold":"normal"},children:t},t)};var c=e=>{let{pagination:t}=e,{currPage:n,totalPages:o,handlePageChange:s}=t,r=[];if(o<=5)for(let e=1;e<=o;e++)r.push((0,a.jsx)(l,{page:e,currPage:n,handlePageChange:s},e));else if(n>o-2)for(let e=o-4;e<=o;e++)r.push((0,a.jsx)(l,{page:e,currPage:n,handlePageChange:s},e));else for(let e=Math.max(n-2,1);e<=Math.max(n+2,5);e++)r.push((0,a.jsx)(l,{page:e,currPage:n,handlePageChange:s},e));return(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{name:"first",className:"pagination-button ".concat(1===n?"disabled":""),disabled:1===n,onClick:()=>s(1),children:"\xab"}),(0,a.jsx)("button",{name:"previous",className:"pagination-button ".concat(1===n?"disabled":""),disabled:1===n,onClick:()=>s(n-1),children:"<"}),r,(0,a.jsx)("button",{name:"next",className:"pagination-button ".concat(n===o?"disabled":""),disabled:n===o,onClick:()=>s(n+1),children:">"}),(0,a.jsx)("button",{name:"last",className:"pagination-button ".concat(n===o?"disabled":""),disabled:n===o,onClick:()=>s(o),children:"\xbb"})]})};n(3080);let i="//localhost:3001/api/notes";function u(){let[e,t]=(0,o.useState)([]),[n,l]=(0,o.useState)(1),[u,d]=(0,o.useState)(1),[m,_]=(0,o.useState)({id:"",title:"",content:""}),[h,g]=(0,o.useState)(!1),[p,x]=(0,o.useState)(!1),[f,b]=(0,o.useState)({create_user_form_name:"",create_user_form_email:"",create_user_form_username:"",create_user_form_password:""}),[j,v]=(0,o.useState)({login_form_username:"",login_form_password:""}),[w,C]=(0,o.useState)(""),[N,y]=(0,o.useState)(!1),[k,E]=(0,o.useState)(!1);(0,o.useEffect)(()=>{s.Z.get(i,{params:{_page:n,_per_page:10}}).then(e=>{t(e.data),d(Math.ceil(parseInt(e.headers["x-total-count"])/10))}).catch(e=>{console.log("Encountered an error:"+e)})},[n]);let S=async n=>{try{await s.Z.delete("".concat(i,"/").concat(n),{headers:{Authorization:"Bearer ".concat(w)}}),t(e.filter(e=>e.id!==n))}catch(e){console.log("Encountered an error while deleting:"+e)}},P=async(n,a)=>{try{await s.Z.put("".concat(i,"/").concat(n),{content:a},{headers:{Authorization:"Bearer ".concat(w)}}),console.log("Updating note ID ".concat(n," with new content:"),a),t(e.map(e=>e.id===n?{...e,content:a}:e))}catch(e){console.error("Encountered an error while updating content:",e)}},U=async()=>{if(!w){console.error("You must be logged in to create a new note.");return}try{let n=await s.Z.post(i,{id:m.id,title:m.title,content:m.content},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(w)}});t([...e,n.data]),g(!1),_({id:"",title:"",content:""})}catch(e){console.error("Encountered an error while adding a new note:",e)}console.log("new note was created")},L=e=>{let{name:t,value:n}=e.target;_(e=>t.startsWith("author.")?(t.split(".")[1],{...e,[t]:n}):"text_input_new_note"===t?{...e,content:n}:{...e,[t]:n})},D=e=>{b({...f,[e.target.name]:e.target.value})},Z=async e=>{e.preventDefault();try{let e=await s.Z.post("http://localhost:3001/api/users/users",{name:f.create_user_form_name,email:f.create_user_form_email,username:f.create_user_form_username,password:f.create_user_form_password});console.log("User created:",e.data),y(!1),b({create_user_form_name:"",create_user_form_email:"",create_user_form_username:"",create_user_form_password:""})}catch(e){console.error("Error creating user:",e),console.log("resigistration failed")}console.log("resigister successfully")},A=e=>{v({...j,[e.target.name]:e.target.value})},T=async e=>{e.preventDefault();try{let e=await s.Z.post("http://localhost:3001/api/users/login",{username:j.login_form_username,password:j.login_form_password});C(e.data.token),console.log("Logged in successfully"),E(!1),v({login_form_username:"",login_form_password:""})}catch(e){if(s.Z.isAxiosError(e)){var t;console.error("Error logging in:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message)}else console.error("Error logging in:",e)}};return(0,a.jsxs)(a.Fragment,{children:[e.map(e=>(0,a.jsx)(r,{post:{...e,onDelete:S,onUpdateContent:P,token:w}},"".concat(e.id))),(0,a.jsx)("div",{className:"pagination",children:(0,a.jsx)(c,{pagination:{currPage:n,totalPages:u,handlePageChange:e=>{l(e)}}})}),(0,a.jsx)("div",{className:"add-new-note",children:h?(0,a.jsxs)("div",{className:"new-note-form",children:[(0,a.jsx)("input",{className:"input-field",type:"text",name:"id",placeholder:"id",value:m.id,onChange:L}),(0,a.jsx)("input",{className:"input-field",type:"text",name:"title",placeholder:"Title",value:m.title,onChange:L}),(0,a.jsx)("textarea",{className:"textarea-field",name:"text_input_new_note",placeholder:"Content",value:m.content,onChange:L}),(0,a.jsx)("button",{className:"button save-button",name:"text_input_save_new_note",onClick:U,children:"Save"}),(0,a.jsx)("button",{className:"button cancel-button",name:"text_input_cancel_new_note",onClick:()=>g(!1),children:"Cancel"})]}):(0,a.jsx)("button",{className:"button add-new-note-button",name:"add-new-note",onClick:()=>g(!0),children:"Add new note"})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"theme-button",onClick:()=>{x(!p),p?document.body.classList.remove("dark-theme"):document.body.classList.add("dark-theme"),console.log("theme has changed")},name:"change_theme",children:"Change Theme"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:"create-user-button",onClick:()=>y(!N),children:N?"Close Create User Form":"Create User"}),N&&(0,a.jsxs)("form",{className:"user-form",name:"create_user_form",onSubmit:Z,children:[(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:["Name:",(0,a.jsx)("input",{className:"input-field",type:"text",name:"create_user_form_name",value:f.create_user_form_name,onChange:D})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:["Email:",(0,a.jsx)("input",{className:"input-field",type:"email",name:"create_user_form_email",value:f.create_user_form_email,onChange:D})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:["Username:",(0,a.jsx)("input",{className:"input-field",type:"text",name:"create_user_form_username",value:f.create_user_form_username,onChange:D})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:["Password:",(0,a.jsx)("input",{className:"input-field",type:"password",name:"create_user_form_password",value:f.create_user_form_password,onChange:D})]})}),(0,a.jsx)("button",{className:"submit-button",type:"submit",name:"create_user_form_create_user",children:"register"})]}),(0,a.jsx)("button",{className:"login-button",onClick:()=>E(!k),children:k?"Close Login Form":"Login"}),k&&(0,a.jsxs)("form",{className:"user-form",name:"login_form",onSubmit:T,children:[(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:["Username:",(0,a.jsx)("input",{className:"input-field",type:"text",name:"login_form_username",value:j.login_form_username,onChange:A})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:["Password:",(0,a.jsx)("input",{className:"input-field",type:"password",name:"login_form_password",value:j.login_form_password,onChange:A})]})}),(0,a.jsx)("button",{className:"submit-button",type:"submit",children:"Log in"})]}),(0,a.jsx)("button",{className:"logout-button",name:"logout",onClick:()=>{C(""),console.log("Logged out successfully")},children:"Logout"})]})]})}},9117:function(){},8883:function(){},3080:function(){}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);